Index: config/custom/jextreme.properties
===================================================================

+# =================================================================
+#                    Anti DualBox System
+# =================================================================
+
+AntiDualBoxEnable = true
+AntiDualBoxMaxConnections = 2
+
+# IPs liberados (LAN house / cyber café)
+# Separe por vírgula
+AntiDualBoxWhitelistedIps = 189.10.20.30,177.55.66.77

Index: java/net/sf/l2j/Config.java
===================================================================

+	public static boolean ANTI_DUALBOX_ENABLE;
+	public static int ANTI_DUALBOX_MAX_CONNECTIONS;
+	public static String ANTI_DUALBOX_WHITELISTED_IPS;
+

+
+ ANTI_DUALBOX_ENABLE = Boolean.parseBoolean(jextreme.getProperty("AntiDualBoxEnable", "false"));
+ ANTI_DUALBOX_MAX_CONNECTIONS = Integer.parseInt(jextreme.getProperty("AntiDualBoxMaxConnections", "1"));
+ ANTI_DUALBOX_WHITELISTED_IPS = jextreme.getProperty("AntiDualBoxWhitelistedIps", "");


Index: java/net/sf/l2j/gameserver/custom/Antidualbox.java
===================================================================
+
+package net.sf.l2j.gameserver.custom;
+
+import java.util.HashSet;
+import java.util.Set;
+
+import net.sf.l2j.Config;
+import net.sf.l2j.commons.pool.ThreadPool;
+import net.sf.l2j.gameserver.model.World;
+import net.sf.l2j.gameserver.model.actor.Player;
+import net.sf.l2j.gameserver.network.serverpackets.ExShowScreenMessage;
+import net.sf.l2j.gameserver.network.serverpackets.ExShowScreenMessage.SMPOS;
+
+/**
+ * @author Vinícius Gonçalves
+ *
+ */
+public class Antidualbox
+{
+	private static final int DISCONNECT_DELAY = 20_000;
+	private static final Set<String> WHITELISTED_IPS = new HashSet<>();
+
+	static
+	{
+		if (Config.ANTI_DUALBOX_WHITELISTED_IPS != null)
+		{
+			for (String ip : Config.ANTI_DUALBOX_WHITELISTED_IPS.split(","))
+				WHITELISTED_IPS.add(ip.trim());
+		}
+	}
+
+	public static void checkAndPunish(Player player)
+	{
+		if (!Config.ANTI_DUALBOX_ENABLE || player == null || player.isGM())
+			return;
+
+		final String ip = getClientAddress(player);
+		if (ip == null)
+			return;
+
+		if (WHITELISTED_IPS.contains(ip))
+			return;
+
+		int connections = 0;
+
+		for (Player other : World.getInstance().getPlayers())
+		{
+			if (other == null || other.isGM())
+				continue;
+
+			final String otherIp = getClientAddress(other);
+			if (otherIp == null)
+				continue;
+
+			if (ip.equals(otherIp))
+				connections++;
+		}
+
+		if (connections > Config.ANTI_DUALBOX_MAX_CONNECTIONS)
+			punish(player);
+	}
+
+	private static void punish(Player player)
+	{
+		// Mensagem inicial
+		player.sendMessage("DualBox não é permitido neste servidor.");
+		// Mensagem Na Tela
+		player.sendPacket(new ExShowScreenMessage(
+			 "DualBox nao e permitido neste servidor",
+				5000,
+				SMPOS.TOP_CENTER,
+				true
+		));
+
+		// Contagem regressiva em segundos
+		int[] countdown = {20, 15, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1};
+
+		for (int seconds : countdown)
+		{
+			int delay = (20 - seconds) * 1000;
+
+			ThreadPool.schedule(() ->
+			{
+				if (!player.isOnline())
+					return;
+
+				String chatMsg = "Você será desconectado em " + seconds + " segundo(s).";
+				String screenMsg = "Voce sera desconectado em " + seconds + " segundos";
+
+				player.sendMessage(chatMsg);
+
+				player.sendPacket(new ExShowScreenMessage(
+						screenMsg,
+						1000,
+						SMPOS.TOP_CENTER,
+						true
+				));
+
+
+			}, delay);
+		}
+
+		// Desconecta após 20 segundos
+		ThreadPool.schedule(() ->
+		{
+			if (player.isOnline())
+				player.logout(true);
+		}, DISCONNECT_DELAY);
+	}
+
+
+	private static String getClientAddress(Player player)
+	{
+		try
+		{
+			return player.getClient().getConnection().getInetAddress().getHostAddress();
+		}
+		catch (Exception e)
+		{
+			return null;
+		}
+	}
+}

Index: java/net/sf/l2j/gameserver/network/clientpackets/EnterWorld.java
===================================================================

+import net.sf.l2j.gameserver.custom.Antidualbox;

 		player.onPlayerEnter();
+
+		Antidualbox.checkAndPunish(player);
 
 		sendPacket(new SkillCoolTime(player));


